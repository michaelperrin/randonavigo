---
import type { CollectionEntry } from "astro:content";
import DonationCard from "./DonationCard.astro";
import Access from "./Access.astro";
import Map from "./Map";
import { getHikeGpxPath } from "../../lib/getHikeGpxPath";
import MapContainer from "../Map/MapContainer";
import DownloadIcon from "../Icon/DownloadIcon.astro";
import Distance from "./Distance.astro";

type Props = CollectionEntry<"hike">["data"];

const {
  starting_point,
  ending_point,
  distance,
  gpx_file,
  slug,
  pubDate,
  gpx_alternatives,
} = Astro.props;

const roundedButtonClasses = {
  rounded: gpx_alternatives === undefined,
  "rounded-t": gpx_alternatives !== undefined,
};
---

<div class="md:mb-12">
  <div class="md:shadow-lg md:rounded-xl font-sans-serif">
    <div
      class="md:p-5 md:border-t md:border-l md:border-r md:border-gray-100 md:rounded-t-xl bg-white"
    >
      <div class="mb-6">
        <h3 class="uppercase text-sm font-bold text-gray-500 mb-2">
          Départ / arrivée
        </h3>
        <Access
          startingPoint={starting_point}
          endingPoint={ending_point}
          transportIconSize={26}
        />
      </div>
      <div class="mb-4">
        <h3 class="uppercase text-sm font-bold text-gray-500 mb-2">Distance</h3>
        <Distance distance={distance} isLoop={!!ending_point} />
      </div>
    </div>

    <!-- <div class="mb-4">
        <div class="flex gap-4 justify-between">
          <div>
            <h3 class="uppercase text-sm font-bold text-gray-500 mb-2">
              Nature
            </h3>
            <div class="flex gap-1">
              <Image
                src="/images/icons/leaf.png"
                width={20}
                height={20}
                alt=""
              />
              <Image
                src="/images/icons/leaf.png"
                width={20}
                height={20}
                alt=""
              />
              <Image
                src="/images/icons/leaf.png"
                width={20}
                height={20}
                alt=""
                class="grayscale opacity-40"
              />
            </div>
          </div>

          <div>
            <h3 class="uppercase text-sm font-bold text-gray-500 mb-2">
              Patrimoine
            </h3>
            <div class="flex gap-1">
              <Image
                src="/images/icons/castle2.png"
                width={12}
                height={12}
                alt=""
              />
              <Image
                src="/images/icons/castle2.png"
                width={12}
                height={12}
                alt=""
              />
              <Image
                src="/images/icons/castle2.png"
                width={12}
                height={12}
                alt=""
                class="grayscale opacity-40"
              />
            </div>
          </div>

          <div>
            <h3 class="uppercase text-sm font-bold text-gray-500 mb-2">
              Difficulté
            </h3>
            <div class="flex gap-1">
              <Image
                src="/images/icons/hiker.svg"
                width={14}
                height={14}
                alt=""
              />
              <Image
                src="/images/icons/hiker.svg"
                width={14}
                height={14}
                alt=""
              />
              <Image
                src="/images/icons/hiker.svg"
                width={14}
                height={14}
                alt=""
                class="grayscale opacity-40"
              />
            </div>
          </div>
        </div>
      </div> -->
    <div>
      <Map
        slug={slug}
        pubDate={pubDate}
        gpxFile={gpx_file}
        client:only="react"
      />
    </div>

    <a
      class:list={[
        "mt-4 md:mt-0 block w-full bg-gradient-to-r from-softblue to-indigo-700 relative z-20 text-white tracking-wider md:after:bg-linear-to-r md:after:from-softblue after:indigo-700 md:after:blur-2xl md:after:absolute md:after:inset-0 md:after:z-10 md:rounded-t-none",
        roundedButtonClasses,
      ]}
      href={getHikeGpxPath(slug, pubDate, gpx_file)}
      role="button"
    >
      <div
        class:list={[
          "rounded-sm flex justify-center items-center z-50  relative text-sm bg-transparent transition-all hover:bg-softblue-light text-center py-4 px-4 uppercase font-semibold duration-500",
          roundedButtonClasses,
        ]}
      >
        <div class="pr-2">
          <DownloadIcon class="w-5 h-5 text-white" />
        </div>
        <div>Télécharger la trace GPS</div>
      </div>
    </a>

    <!--
      {gpx_alternatives && (
        <div class="font-sans-serif text-sm bg-slate-50/70 z-20 relative rounded-b py-5 px-6 shadow-xl shadow-slate-200">
          <div class="uppercase font-semibold text-gray-600 mb-2">
            Trace GPS alternative
          </div>
          <ul>
            {gpx_alternatives.map((alternative) => (
              <li>
                <a
                  href={getHikeGpxPath(
                    slug,
                    pubDate,
                    alternative.file
                  )}
                  class="font-medium text-gray-800"
                >
                  <svg class="w-3 h-3 inline mr-1" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                  </svg>
                  {alternative.label}
                </a>
              </li>
            ))}
          </ul>
        </div>
      )} -->

    <!-- <div class="font-sans-serif font-bold text-sm text-center mt-2">
        <a href="/aide/gpx">
          <svg class="w-4 h-4 inline mr-1" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd"></path>
          </svg>
          Aide
        </a>
      </div> -->
  </div>
</div>

<div class="mt-8 md:mt-16">
  <DonationCard />
</div>
